'''
Created on May 8, 2012

@author: pergr
'''

xml = '''<?xml version="1.0" encoding="UTF-8"?>
<ns0:getRosterResponse xmlns:ns0="http://carmen.jeppesen.com/crewweb/framework/xmlschema/backendcommunication/getroster" xmlns:ns1="http://carmen.jeppesen.com/crewweb/framework/xmlschema/common" xmlns:ns2="http://carmen.jeppesen.com/crewweb/framework/xmlschema/trip">
<ns0:roster>
    <ns2:CRR endDateTime="2012-01-07 00:00" startDateTime="2012-01-03 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-01-16 00:00" startDateTime="2012-01-12 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-01-25 00:00" startDateTime="2012-01-21 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-02-03 00:00" startDateTime="2012-01-30 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-02-12 00:00" startDateTime="2012-02-08 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-02-21 00:00" startDateTime="2012-02-17 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-03-01 00:00" startDateTime="2012-02-26 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-03-10 00:00" startDateTime="2012-03-06 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-03-19 00:00" startDateTime="2012-03-15 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-03-28 00:00" startDateTime="2012-03-24 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-04-06 00:00" startDateTime="2012-04-02 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-04-15 00:00" startDateTime="2012-04-11 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-04-24 00:00" startDateTime="2012-04-20 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-05-03 00:00" startDateTime="2012-04-29 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-05-12 00:00" startDateTime="2012-05-08 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-05-21 00:00" startDateTime="2012-05-17 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-05-30 00:00" startDateTime="2012-05-26 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-06-08 00:00" startDateTime="2012-06-04 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-06-17 00:00" startDateTime="2012-06-13 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-06-26 00:00" startDateTime="2012-06-22 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-07-05 00:00" startDateTime="2012-07-01 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-07-14 00:00" startDateTime="2012-07-10 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-07-23 00:00" startDateTime="2012-07-19 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-08-01 00:00" startDateTime="2012-07-28 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-08-10 00:00" startDateTime="2012-08-06 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-08-19 00:00" startDateTime="2012-08-15 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-08-28 00:00" startDateTime="2012-08-24 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
    <ns2:CRR endDateTime="2012-09-06 00:00" startDateTime="2012-09-02 00:00" type="personal">
        <ns2:attributes>
            <ns1:attribute name="code" value="F"/>
        </ns2:attributes>
    </ns2:CRR>
</ns0:roster>
</ns0:getRosterResponse>
'''

from xml.etree.ElementTree import Element
from xml.etree import ElementTree
#import interbids.rostering.xml_handler.treeelement_factory as tt

#reload(tt)
#TT = tt.TreeElementFactory()
ns0 = 'http://carmen.jeppesen.com/crewweb/framework/xmlschema/backendcommunication/getroster'
ns2 = 'http://carmen.jeppesen.com/crewweb/framework/xmlschema/trip'
ns1="http://carmen.jeppesen.com/crewweb/framework/xmlschema/common"

roster_tag = 'roster'
crr_tag = 'CRR'
attributes_tag = 'attributes'
attribute_tag = 'attribute'

endDateTime_tag = 'endDateTime'
startDateTime_tag = 'startDateTime'
type_tag = 'type'
name_tag = 'name'
value_tag = 'value'

tree = ElementTree.fromstring(xml)
roster = tree.find('{%s}%s'%(ns0,roster_tag))
if not roster is None:
    for node in roster.findall('{%s}%s'%(ns2, crr_tag)):
        endDateTime  =  node.get(endDateTime_tag)
        startDateTime = node.get(startDateTime_tag)
        _type =  node.get(type_tag)
        print startDateTime, endDateTime, _type
        for attributes in node.findall('{%s}%s'%(ns2,attributes_tag)):
            for attribute in attributes.findall('{%s}%s'%(ns1, attribute_tag)):
                name = attribute.get(name_tag)
                value = attribute.get(value_tag)
                print name, '=', value
        
print roster
for node in tree:
    print node
print tree