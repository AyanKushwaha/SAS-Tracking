import adhoc.fixrunner as fixrunner
import adhoc.migrate_table as migrate_table
import AbsTime

data_tbl = [('accumulators.fdc15_nr_entitled_freedays_acc','10123','01May2017',117),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10123','01May2017',121),
('accumulators.fdc15_nr_entitled_freedays_acc','10127','01May2017',99),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10127','01May2017',101),
('accumulators.fdc15_nr_entitled_freedays_acc','10140','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10140','01May2017',120),
('accumulators.fdc15_nr_entitled_freedays_acc','10145','01May2017',117),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10145','01May2017',119),
('accumulators.fdc15_nr_entitled_freedays_acc','10147','01May2017',156),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10147','01May2017',155),
('accumulators.fdc15_nr_entitled_freedays_acc','10155','01May2017',115),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10155','01May2017',120),
('accumulators.fdc15_nr_entitled_freedays_acc','10158','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10158','01May2017',119),
('accumulators.fdc15_nr_entitled_freedays_acc','10184','01May2017',97),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10184','01May2017',100),
('accumulators.fdc15_nr_entitled_freedays_acc','10188','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10188','01May2017',119),
('accumulators.fdc15_nr_entitled_freedays_acc','10191','01May2017',118),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10191','01May2017',121),
('accumulators.fdc15_nr_entitled_freedays_acc','10194','01May2017',107),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10194','01May2017',111),
('accumulators.fdc15_nr_entitled_freedays_acc','10199','01May2017',119),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10199','01May2017',122),
('accumulators.fdc15_nr_entitled_freedays_acc','10200','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10200','01May2017',119),
('accumulators.fdc15_nr_entitled_freedays_acc','10208','01May2017',115),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10208','01May2017',120),
('accumulators.fdc15_nr_entitled_freedays_acc','10220','01May2017',108),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10220','01May2017',112),
('accumulators.fdc15_nr_entitled_freedays_acc','10241','01May2017',115),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10241','01May2017',114),
('accumulators.fdc15_nr_entitled_freedays_acc','10262','01May2017',113),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10262','01May2017',116),
('accumulators.fdc15_nr_entitled_freedays_acc','10283','01May2017',115),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10283','01May2017',114),
('accumulators.fdc15_nr_entitled_freedays_acc','10319','01May2017',126),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10319','01May2017',126),
('accumulators.fdc15_nr_entitled_freedays_acc','10350','01May2017',69),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10350','01May2017',69),
('accumulators.fdc15_nr_entitled_freedays_acc','10373','01May2017',81),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10373','01May2017',81),
('accumulators.fdc15_nr_entitled_freedays_acc','10457','01May2017',110),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10457','01May2017',109),
('accumulators.fdc15_nr_entitled_freedays_acc','10567','01May2017',129),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10567','01May2017',128),
('accumulators.fdc15_nr_entitled_freedays_acc','10577','01May2017',120),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10577','01May2017',82),
('accumulators.fdc15_nr_entitled_freedays_acc','10587','01May2017',112),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10587','01May2017',111),
('accumulators.fdc15_nr_entitled_freedays_acc','10607','01May2017',110),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10607','01May2017',109),
('accumulators.fdc15_nr_entitled_freedays_acc','10665','01May2017',111),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10665','01May2017',110),
('accumulators.fdc15_nr_entitled_freedays_acc','10725','01May2017',119),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10725','01May2017',122),
('accumulators.fdc15_nr_entitled_freedays_acc','10728','01May2017',110),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10728','01May2017',113),
('accumulators.fdc15_nr_entitled_freedays_acc','10750','01May2017',110),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10750','01May2017',110),
('accumulators.fdc15_nr_entitled_freedays_acc','10756','01May2017',48),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10756','01May2017',51),
('accumulators.fdc15_nr_entitled_freedays_acc','10762','01May2017',111),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10762','01May2017',110),
('accumulators.fdc15_nr_entitled_freedays_acc','10775','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10775','01May2017',120),
('accumulators.fdc15_nr_entitled_freedays_acc','10776','01May2017',111),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10776','01May2017',114),
('accumulators.fdc15_nr_entitled_freedays_acc','10789','01May2017',113),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10789','01May2017',112),
('accumulators.fdc15_nr_entitled_freedays_acc','10809','01May2017',114),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10809','01May2017',119),
('accumulators.fdc15_nr_entitled_freedays_acc','10818','01May2017',115),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10818','01May2017',81),
('accumulators.fdc15_nr_entitled_freedays_acc','10851','01May2017',112),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10851','01May2017',116),
('accumulators.fdc15_nr_entitled_freedays_acc','10866','01May2017',111),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10866','01May2017',115),
('accumulators.fdc15_nr_entitled_freedays_acc','10874','01May2017',112),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10874','01May2017',115),
('accumulators.fdc15_nr_entitled_freedays_acc','10875','01May2017',114),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10875','01May2017',117),
('accumulators.fdc15_nr_entitled_freedays_acc','10880','01May2017',174),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10880','01May2017',178),
('accumulators.fdc15_nr_entitled_freedays_acc','10891','01May2017',106),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10891','01May2017',111),
('accumulators.fdc15_nr_entitled_freedays_acc','10893','01May2017',107),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10893','01May2017',112),
('accumulators.fdc15_nr_entitled_freedays_acc','10962','01May2017',129),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','10962','01May2017',128),
('accumulators.fdc15_nr_entitled_freedays_acc','11026','01May2017',108),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11026','01May2017',107),
('accumulators.fdc15_nr_entitled_freedays_acc','11038','01May2017',120),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11038','01May2017',119),
('accumulators.fdc15_nr_entitled_freedays_acc','11072','01May2017',113),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11072','01May2017',118),
('accumulators.fdc15_nr_entitled_freedays_acc','11086','01May2017',85),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11086','01May2017',88),
('accumulators.fdc15_nr_entitled_freedays_acc','11099','01May2017',153),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11099','01May2017',159),
('accumulators.fdc15_nr_entitled_freedays_acc','11102','01May2017',125),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11102','01May2017',124),
('accumulators.fdc15_nr_entitled_freedays_acc','11134','01May2017',110),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11134','01May2017',110),
('accumulators.fdc15_nr_entitled_freedays_acc','11145','01May2017',111),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11145','01May2017',110),
('accumulators.fdc15_nr_entitled_freedays_acc','11170','01May2017',33),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11170','01May2017',32),
('accumulators.fdc15_nr_entitled_freedays_acc','11250','01May2017',78),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11250','01May2017',77),
('accumulators.fdc15_nr_entitled_freedays_acc','11259','01May2017',115),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11259','01May2017',115),
('accumulators.fdc15_nr_entitled_freedays_acc','11269','01May2017',114),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11269','01May2017',118),
('accumulators.fdc15_nr_entitled_freedays_acc','11313','01May2017',114),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11313','01May2017',118),
('accumulators.fdc15_nr_entitled_freedays_acc','11319','01May2017',159),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11319','01May2017',158),
('accumulators.fdc15_nr_entitled_freedays_acc','11380','01May2017',119),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11380','01May2017',118),
('accumulators.fdc15_nr_entitled_freedays_acc','11382','01May2017',107),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11382','01May2017',106),
('accumulators.fdc15_nr_entitled_freedays_acc','11518','01May2017',159),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11518','01May2017',158),
('accumulators.fdc15_nr_entitled_freedays_acc','11520','01May2017',112),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11520','01May2017',118),
('accumulators.fdc15_nr_entitled_freedays_acc','11564','01May2017',112),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11564','01May2017',112),
('accumulators.fdc15_nr_entitled_freedays_acc','11648','01May2017',104),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11648','01May2017',108),
('accumulators.fdc15_nr_entitled_freedays_acc','11649','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11649','01May2017',119),
('accumulators.fdc15_nr_entitled_freedays_acc','11681','01May2017',106),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11681','01May2017',111),
('accumulators.fdc15_nr_entitled_freedays_acc','11685','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11685','01May2017',119),
('accumulators.fdc15_nr_entitled_freedays_acc','11696','01May2017',118),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11696','01May2017',122),
('accumulators.fdc15_nr_entitled_freedays_acc','11705','01May2017',120),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11705','01May2017',124),
('accumulators.fdc15_nr_entitled_freedays_acc','11713','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11713','01May2017',120),
('accumulators.fdc15_nr_entitled_freedays_acc','11719','01May2017',122),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11719','01May2017',127),
('accumulators.fdc15_nr_entitled_freedays_acc','11720','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11720','01May2017',119),
('accumulators.fdc15_nr_entitled_freedays_acc','11721','01May2017',101),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11721','01May2017',104),
('accumulators.fdc15_nr_entitled_freedays_acc','11750','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11750','01May2017',115),
('accumulators.fdc15_nr_entitled_freedays_acc','11799','01May2017',110),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11799','01May2017',109),
('accumulators.fdc15_nr_entitled_freedays_acc','11829','01May2017',22),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11829','01May2017',27),
('accumulators.fdc15_nr_entitled_freedays_acc','11836','01May2017',119),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11836','01May2017',122),
('accumulators.fdc15_nr_entitled_freedays_acc','11841','01May2017',113),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11841','01May2017',116),
('accumulators.fdc15_nr_entitled_freedays_acc','11851','01May2017',119),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11851','01May2017',123),
('accumulators.fdc15_nr_entitled_freedays_acc','11856','01May2017',120),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11856','01May2017',122),
('accumulators.fdc15_nr_entitled_freedays_acc','11859','01May2017',109),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11859','01May2017',111),
('accumulators.fdc15_nr_entitled_freedays_acc','11863','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11863','01May2017',119),
('accumulators.fdc15_nr_entitled_freedays_acc','11884','01May2017',115),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11884','01May2017',118),
('accumulators.fdc15_nr_entitled_freedays_acc','11888','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11888','01May2017',118),
('accumulators.fdc15_nr_entitled_freedays_acc','11890','01May2017',122),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11890','01May2017',127),
('accumulators.fdc15_nr_entitled_freedays_acc','11896','01May2017',115),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11896','01May2017',118),
('accumulators.fdc15_nr_entitled_freedays_acc','11910','01May2017',126),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11910','01May2017',129),
('accumulators.fdc15_nr_entitled_freedays_acc','11921','01May2017',122),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11921','01May2017',126),
('accumulators.fdc15_nr_entitled_freedays_acc','11924','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11924','01May2017',119),
('accumulators.fdc15_nr_entitled_freedays_acc','11931','01May2017',119),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11931','01May2017',122),
('accumulators.fdc15_nr_entitled_freedays_acc','11933','01May2017',119),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11933','01May2017',121),
('accumulators.fdc15_nr_entitled_freedays_acc','11936','01May2017',156),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11936','01May2017',155),
('accumulators.fdc15_nr_entitled_freedays_acc','11938','01May2017',157),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11938','01May2017',156),
('accumulators.fdc15_nr_entitled_freedays_acc','11941','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11941','01May2017',122),
('accumulators.fdc15_nr_entitled_freedays_acc','11942','01May2017',108),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11942','01May2017',111),
('accumulators.fdc15_nr_entitled_freedays_acc','11960','01May2017',112),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','11960','01May2017',113),
('accumulators.fdc15_nr_entitled_freedays_acc','12014','01May2017',108),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','12014','01May2017',110),
('accumulators.fdc15_nr_entitled_freedays_acc','12176','01May2017',117),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','12176','01May2017',116),
('accumulators.fdc15_nr_entitled_freedays_acc','12223','01May2017',100),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','12223','01May2017',108),
('accumulators.fdc15_nr_entitled_freedays_acc','12237','01May2017',112),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','12237','01May2017',111),
('accumulators.fdc15_nr_entitled_freedays_acc','12412','01May2017',105),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','12412','01May2017',105),
('accumulators.fdc15_nr_entitled_freedays_acc','12439','01May2017',0),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','12439','01May2017',1),
('accumulators.fdc15_nr_entitled_freedays_acc','12448','01May2017',125),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','12448','01May2017',128),
('accumulators.fdc15_nr_entitled_freedays_acc','12485','01May2017',109),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','12485','01May2017',108),
('accumulators.fdc15_nr_entitled_freedays_acc','12999','01May2017',113),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','12999','01May2017',117),
('accumulators.fdc15_nr_entitled_freedays_acc','13158','01May2017',109),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','13158','01May2017',111),
('accumulators.fdc15_nr_entitled_freedays_acc','13218','01May2017',119),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','13218','01May2017',122),
('accumulators.fdc15_nr_entitled_freedays_acc','13649','01May2017',125),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','13649','01May2017',124),
('accumulators.fdc15_nr_entitled_freedays_acc','13751','01May2017',114),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','13751','01May2017',113),
('accumulators.fdc15_nr_entitled_freedays_acc','13858','01May2017',101),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','13858','01May2017',101),
('accumulators.fdc15_nr_entitled_freedays_acc','14413','01May2017',108),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','14413','01May2017',107),
('accumulators.fdc15_nr_entitled_freedays_acc','14418','01May2017',109),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','14418','01May2017',108),
('accumulators.fdc15_nr_entitled_freedays_acc','14446','01May2017',112),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','14446','01May2017',111),
('accumulators.fdc15_nr_entitled_freedays_acc','14521','01May2017',109),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','14521','01May2017',108),
('accumulators.fdc15_nr_entitled_freedays_acc','14616','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','14616','01May2017',79),
('accumulators.fdc15_nr_entitled_freedays_acc','14641','01May2017',71),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','14641','01May2017',70),
('accumulators.fdc15_nr_entitled_freedays_acc','14724','01May2017',110),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','14724','01May2017',109),
('accumulators.fdc15_nr_entitled_freedays_acc','14754','01May2017',85),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','14754','01May2017',84),
('accumulators.fdc15_nr_entitled_freedays_acc','14799','01May2017',142),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','14799','01May2017',141),
('accumulators.fdc15_nr_entitled_freedays_acc','14803','01May2017',156),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','14803','01May2017',155),
('accumulators.fdc15_nr_entitled_freedays_acc','14846','01May2017',161),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','14846','01May2017',162),
('accumulators.fdc15_nr_entitled_freedays_acc','14873','01May2017',112),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','14873','01May2017',111),
('accumulators.fdc15_nr_entitled_freedays_acc','15246','01May2017',107),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','15246','01May2017',106),
('accumulators.fdc15_nr_entitled_freedays_acc','15381','01May2017',111),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','15381','01May2017',110),
('accumulators.fdc15_nr_entitled_freedays_acc','15459','01May2017',36),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','15459','01May2017',37),
('accumulators.fdc15_nr_entitled_freedays_acc','15462','01May2017',48),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','15462','01May2017',49),
('accumulators.fdc15_nr_entitled_freedays_acc','16106','01May2017',112),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','16106','01May2017',112),
('accumulators.fdc15_nr_entitled_freedays_acc','16151','01May2017',114),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','16151','01May2017',113),
('accumulators.fdc15_nr_entitled_freedays_acc','16312','01May2017',156),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','16312','01May2017',155),
('accumulators.fdc15_nr_entitled_freedays_acc','17007','01May2017',113),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','17007','01May2017',112),
('accumulators.fdc15_nr_entitled_freedays_acc','17076','01May2017',112),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','17076','01May2017',116),
('accumulators.fdc15_nr_entitled_freedays_acc','17082','01May2017',114),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','17082','01May2017',117),
('accumulators.fdc15_nr_entitled_freedays_acc','17083','01May2017',124),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','17083','01May2017',127),
('accumulators.fdc15_nr_entitled_freedays_acc','17099','01May2017',127),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','17099','01May2017',132),
('accumulators.fdc15_nr_entitled_freedays_acc','17102','01May2017',127),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','17102','01May2017',132),
('accumulators.fdc15_nr_entitled_freedays_acc','17106','01May2017',130),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','17106','01May2017',138),
('accumulators.fdc15_nr_entitled_freedays_acc','17109','01May2017',127),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','17109','01May2017',134),
('accumulators.fdc15_nr_entitled_freedays_acc','17112','01May2017',130),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','17112','01May2017',134),
('accumulators.fdc15_nr_entitled_freedays_acc','17120','01May2017',130),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','17120','01May2017',138),
('accumulators.fdc15_nr_entitled_freedays_acc','17122','01May2017',112),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','17122','01May2017',119),
('accumulators.fdc15_nr_entitled_freedays_acc','17623','01May2017',116),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','17623','01May2017',116),
('accumulators.fdc15_nr_entitled_freedays_acc','17816','01May2017',114),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','17816','01May2017',114),
('accumulators.fdc15_nr_entitled_freedays_acc','18524','01May2017',115),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','18524','01May2017',114),
('accumulators.fdc15_nr_entitled_freedays_acc','18898','01May2017',118),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','18898','01May2017',117),
('accumulators.fdc15_nr_entitled_freedays_acc','18920','01May2017',40),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','18920','01May2017',41),
('accumulators.fdc15_nr_entitled_freedays_acc','18927','01May2017',108),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','18927','01May2017',108),
('accumulators.fdc15_nr_entitled_freedays_acc','18938','01May2017',13),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','18938','01May2017',13),
('accumulators.fdc15_nr_entitled_freedays_acc','18939','01May2017',77),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','18939','01May2017',76),
('accumulators.fdc15_nr_entitled_freedays_acc','18957','01May2017',13),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','18957','01May2017',12),
('accumulators.fdc15_nr_entitled_freedays_acc','18959','01May2017',113),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','18959','01May2017',112),
('accumulators.fdc15_nr_entitled_freedays_acc','18964','01May2017',13),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','18964','01May2017',16),
('accumulators.fdc15_nr_entitled_freedays_acc','18970','01May2017',13),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','18970','01May2017',15),
('accumulators.fdc15_nr_entitled_freedays_acc','19005','01May2017',151),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','19005','01May2017',150),
('accumulators.fdc15_nr_entitled_freedays_acc','19334','01May2017',110),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','19334','01May2017',109),
('accumulators.fdc15_nr_entitled_freedays_acc','19395','01May2017',145),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','19395','01May2017',150),
('accumulators.fdc15_nr_entitled_freedays_acc','19401','01May2017',124),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','19401','01May2017',128),
('accumulators.fdc15_nr_entitled_freedays_acc','19665','01May2017',112),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','19665','01May2017',111),
('accumulators.fdc15_nr_entitled_freedays_acc','19736','01May2017',155),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','19736','01May2017',155),
('accumulators.fdc15_nr_entitled_freedays_acc','19815','01May2017',107),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','19815','01May2017',106),
('accumulators.fdc15_nr_entitled_freedays_acc','19862','01May2017',162),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','19862','01May2017',161),
('accumulators.fdc15_nr_entitled_freedays_acc','19917','01May2017',80),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','19917','01May2017',79),
('accumulators.fdc15_nr_entitled_freedays_acc','19926','01May2017',151),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','19926','01May2017',150),
('accumulators.fdc15_nr_entitled_freedays_acc','19940','01May2017',123),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','19940','01May2017',126),
('accumulators.fdc15_nr_entitled_freedays_acc','19956','01May2017',109),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','19956','01May2017',108),
('accumulators.fdc15_nr_entitled_freedays_acc','19970','01May2017',228),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','19970','01May2017',228),
('accumulators.fdc15_nr_entitled_freedays_acc','19996','01May2017',108),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','19996','01May2017',108),
('accumulators.fdc15_nr_entitled_freedays_acc','34718','01May2017',160),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','34718','01May2017',163),
('accumulators.fdc15_nr_entitled_freedays_acc','34856','01May2017',161),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','34856','01May2017',162),
('accumulators.fdc15_nr_entitled_freedays_acc','38140','01May2017',160),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','38140','01May2017',162),
('accumulators.fdc15_nr_entitled_freedays_acc','38409','01May2017',156),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','38409','01May2017',157),
('accumulators.fdc15_nr_entitled_freedays_acc','38411','01May2017',162),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','38411','01May2017',164),
('accumulators.fdc15_nr_entitled_freedays_acc','38673','01May2017',174),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','38673','01May2017',174),
('accumulators.fdc15_nr_entitled_freedays_acc','38738','01May2017',165),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','38738','01May2017',168),
('accumulators.fdc15_nr_entitled_freedays_acc','38930','01May2017',147),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','38930','01May2017',150),
('accumulators.fdc15_nr_entitled_freedays_acc','39620','01May2017',162),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','39620','01May2017',165),
('accumulators.fdc15_nr_entitled_freedays_acc','44135','01May2017',128),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','44135','01May2017',129),
('accumulators.fdc15_nr_entitled_freedays_acc','44137','01May2017',110),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','44137','01May2017',110),
('accumulators.fdc15_nr_entitled_freedays_acc','46508','01May2017',130),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','46508','01May2017',302),
('accumulators.fdc15_nr_entitled_freedays_acc','49913','01May2017',117),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','49913','01May2017',119),
('accumulators.fdc15_nr_entitled_freedays_acc','66405','01May2017',109),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','66405','01May2017',112),
('accumulators.fdc15_nr_entitled_freedays_acc','67928','01May2017',120),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','67928','01May2017',125),
('accumulators.fdc15_nr_entitled_freedays_acc','68306','01May2017',115),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','68306','01May2017',117),
('accumulators.fdc15_nr_entitled_freedays_acc','86117','01May2017',146),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','86117','01May2017',148),
('accumulators.fdc15_nr_entitled_freedays_acc','86247','01May2017',12),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','86247','01May2017',11),
('accumulators.fdc15_nr_entitled_freedays_acc','87129','01May2017',114),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','87129','01May2017',114),
('accumulators.fdc15_nr_entitled_freedays_acc','87147','01May2017',127),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','87147','01May2017',130),
('accumulators.fdc15_nr_entitled_freedays_acc','87151','01May2017',31),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','87151','01May2017',33),
('accumulators.fdc15_nr_entitled_freedays_acc','87153','01May2017',131),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','87153','01May2017',133),
('accumulators.fdc15_nr_entitled_freedays_acc','87159','01May2017',113),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','87159','01May2017',103),
('accumulators.fdc15_nr_entitled_freedays_acc','87161','01May2017',105),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','87161','01May2017',110),
('accumulators.fdc15_nr_entitled_freedays_acc','87163','01May2017',149),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','87163','01May2017',151),
('accumulators.fdc15_nr_entitled_freedays_acc','87792','01May2017',118),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','87792','01May2017',94),
('accumulators.fdc15_nr_entitled_freedays_acc','87801','01May2017',13),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','87801','01May2017',13),
('accumulators.fdc15_nr_entitled_freedays_acc','87805','01May2017',97),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','87805','01May2017',101),
('accumulators.fdc15_nr_entitled_freedays_acc','87808','01May2017',94),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','87808','01May2017',96),
('accumulators.fdc15_nr_entitled_freedays_acc','87813','01May2017',127),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','87813','01May2017',129),
('accumulators.fdc15_nr_entitled_freedays_acc','87905','01May2017',120),
('accumulators.fdc15_nr_possibly_scheduled_freedays_acc','87905','01May2017',113)]


__version__ = '2017_04_10'


def minuteval_date(date_str):
    return int(AbsTime.AbsTime(date_str))

def date_to_int(date_val):
    return date_val if type(date_val) == int else minuteval_date(date_val)

@fixrunner.once
@fixrunner.run
def fixit(dc, *a, **k):
    ops = []
    acc_tbl = migrate_table.MigrateTable(dc, fixrunner, 'accumulator_int', ['name', 'acckey', 'tim', 'val'],3)
    acc_tbl.load('tim >= ' + str(minuteval_date('1Jan2017')))

    for r in data_tbl:
        x = acc_tbl.crt_row([r[0], r[1], date_to_int(r[2]), r[3]])
        acc_tbl.put_row(ops, x)
    acc_tbl.write_orig()

    print "Done, ops= ", len(ops)
    return ops

fixit.program = 'acc_fix.py (%s)' % __version__

if __name__ == '__main__':
    try:
        fixit()
    except fixrunner.OnceException:
        print "    - migration alreay run with key ", __version___
